<ui:composition template="/templates/pageTemplate.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:am="http://alertmonitor.io/facelets">

	<div id="contentFrame">
		<ui:define name="contentFrame">

			<h:form id="queryForm">
				<p:outputLabel value="Query: "/>
				<!--<p:inplace editor="true">-->
					<!--<p:inputText value="#{uiQueryBean.query}" required="true" label="text"/>-->
				<!--</p:inplace>-->
				<br/>
				<p:inputText id="queryString" value="#{uiQueryBean.query}" style="width: 100%"/>
				<p:commandButton value="Execute"  update="display" action="#{uiQueryBean.executeQuery}"/>
			</h:form>

			<hr/>

<!--			<p:outputLabel id="display" value="#{uiQueryBean.result}"/>-->

			<h:form id="display">
			<ui:repeat var="r" value="#{uiQueryBean.queryResult}">
				<div class="card">
					<p:outputPanel deferred="true" deferredMode="visible" class="p-mt-2">
						<h5>Labels</h5>
						<p>#{r.metric}</p>
						<p:outputPanel rendered="#{r.value != null}">
							<h5>Value</h5>
							<p>#{r.value[1]} @ #{uiQueryBean.toNormalDate(r.value[0].toString())}</p>
						</p:outputPanel>
						<p:outputPanel rendered="#{r.values != null}">
							<h5>Values</h5>
							<ui:repeat var="v" value="#{r.values}">
								<p>#{v[1]} @ #{uiQueryBean.toNormalDate(v[0])}</p>
							</ui:repeat>
						</p:outputPanel>


					</p:outputPanel>
				</div>
			</ui:repeat>
			</h:form>

		</ui:define>
	</div>

</ui:composition>

